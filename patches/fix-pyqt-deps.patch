diff --git a/data/windows/build-pyqt.sh b/data/windows/build-pyqt.sh
index b52b3500e..ca46ff7a0 100755
--- a/data/windows/build-pyqt.sh
+++ b/data/windows/build-pyqt.sh
@@ -66,55 +66,54 @@ fi
 # list packages
 
 PACKAGES=(
-  "binutils-2.32-3"
-  "bzip2-1.0.8-1"
-  "crt-git-7.0.0.5524.2346384e-1"
-  "dbus-1.12.8-1"
-  "double-conversion-3.1.5-1"
-  "expat-2.2.8-1"
-  "freetype-2.10.1-1"
-  "gcc-9.2.0-2"
-  "gcc-libs-9.2.0-2"
-  "gettext-0.19.8.1-8"
-  "glib2-2.62.1-1"
-  "gmp-6.1.2-1"
-  "graphite2-1.3.13-1"
-  "harfbuzz-2.6.2-1"
-  "icu-64.2-1"
-  "jasper-2.0.16-1"
-  "libffi-3.2.1-4"
-  "libiconv-1.16-1"
-  "libjpeg-turbo-2.0.3-1"
-  "libpng-1.6.37-3"
-  "libtiff-4.0.9-2"
-  "libwebp-1.0.3-1"
-  "libxml2-2.9.9-2"
-  "libxslt-1.1.33-1"
-  "libwinpthread-git-7.0.0.5522.977a9720-1"
-  "headers-git-7.0.0.5524.2346384e-1"
-  "openssl-1.1.1.d-1"
-  "pcre-8.43-1"
-  "pcre2-10.33-1"
-  "pyqt5-common-5.13.1-1"
-  "python3-3.7.4-7"
-  "python3-cx_Freeze-5.1.1-3"
-  "python3-nuitka-0.6.4-1"
-  "python3-sip-4.19.19-1"
-  "python3-pyqt5-5.13.1-1"
-  "qt5-5.13.1-1"
-  "qtwebkit-5.212.0alpha2-6"
-  "sqlite3-3.30.0-1"
-  "windows-default-manifest-6.4-3"
-  "winpthreads-git-7.0.0.5522.977a9720-1"
-  "xz-5.2.4-1"
-  "zlib-1.2.11-7"
-  "zstd-1.4.3-1"
+  "binutils-2.34-1-any.pkg.tar.xz"
+  "bzip2-1.0.8-1-any.pkg.tar.xz"
+  "crt-git-8.0.0.5815.9517d302-1-any.pkg.tar.xz"
+  "dbus-1.12.16-3-any.pkg.tar.xz"
+  "double-conversion-3.1.5-1-any.pkg.tar.xz"
+  "expat-2.2.9-1-any.pkg.tar.xz"
+  "freetype-2.10.1-1-any.pkg.tar.xz"
+  "gcc-9.3.0-2-any.pkg.tar.xz"
+  "gcc-libs-9.3.0-2-any.pkg.tar.xz"
+  "gettext-0.19.8.1-8-any.pkg.tar.xz"
+  "glib2-2.64.2-1-any.pkg.tar.xz"
+  "gmp-6.2.0-1-any.pkg.tar.xz"
+  "graphite2-1.3.14-1-any.pkg.tar.xz"
+  "harfbuzz-2.6.5-1-any.pkg.tar.xz"
+  "icu-65.1-1-any.pkg.tar.xz"
+  "jasper-2.0.16-1-any.pkg.tar.xz"
+  "libffi-3.3-1-any.pkg.tar.xz"
+  "libiconv-1.16-1-any.pkg.tar.xz"
+  "libjpeg-turbo-2.0.4-1-any.pkg.tar.xz"
+  "libpng-1.6.37-3-any.pkg.tar.xz"
+  "libtiff-4.1.0-1-any.pkg.tar.xz"
+  "libwebp-1.1.0-1-any.pkg.tar.xz"
+  "libxml2-2.9.9-3-any.pkg.tar.xz"
+  "libxslt-1.1.34-2-any.pkg.tar.xz"
+  "libwinpthread-git-8.0.0.5814.9dbf4cc1-1-any.pkg.tar.xz"
+  "headers-git-8.0.0.5815.9517d302-1-any.pkg.tar.xz"
+  "openssl-1.1.1.g-1-any.pkg.tar.xz"
+  "pcre-8.44-1-any.pkg.tar.xz"
+  "pcre2-10.34-1-any.pkg.tar.xz"
+  "pyqt5-common-5.13.2-1-any.pkg.tar.xz"
+  "python3-cx_Freeze-6.0-1-any.pkg.tar.xz"
+  "python3-3.8.1-2-any.pkg.tar.xz"
+  "python3-nuitka-0.6.5-1-any.pkg.tar.xz"
+  "python3-sip-4.19.20-1-any.pkg.tar.xz"
+  "python3-pyqt5-5.13.2-2-any.pkg.tar.xz"
+  "qt5-5.14.2-2-any.pkg.tar.xz"
+  "qtwebkit-5.212.0alpha4-2-any.pkg.tar.xz"
+  "sqlite3-3.31.1-1-any.pkg.tar.xz"
+  "windows-default-manifest-6.4-3-any.pkg.tar.xz"
+  "winpthreads-git-8.0.0.5814.9dbf4cc1-1-any.pkg.tar.xz"
+  "xz-5.2.5-1-any.pkg.tar.xz"
+  "zlib-1.2.11-7-any.pkg.tar.xz"
+  "zstd-1.4.4-1-any.pkg.tar.xz"
 )
 # qt5-static-5.12.4-1
 
 PKG_DIR="$(pwd)/python-pkgs-${CPUARCH}"
 PKG_PREFIX="mingw-w64-${CPUARCH}-"
-PKG_SUFFIX="-any.pkg.tar.xz"
 
 REPO_URL="http://repo.msys2.org/mingw/${CPUARCH}"
 
@@ -125,7 +124,7 @@ mkdir -p "${PKG_DIR}"
 pushd "${PKG_DIR}"
 
 for PKG in ${PACKAGES[@]}; do
-  wget -c "${REPO_URL}/${PKG_PREFIX}${PKG}${PKG_SUFFIX}"
+  wget -c "${REPO_URL}/${PKG_PREFIX}${PKG}"
 done
 
 popd
@@ -139,7 +138,11 @@ mkdir "${TARGETDIR}/msys2-${CPUARCH}"
 pushd "${TARGETDIR}/msys2-${CPUARCH}"
 
 for PKG in ${PACKAGES[@]}; do
-  tar xf "${PKG_DIR}/${PKG_PREFIX}${PKG}${PKG_SUFFIX}"
+  if [[ $PKG =~ \.zst$ ]]; then
+    tar -I zstd -xf "${PKG_DIR}/${PKG_PREFIX}${PKG}"
+  else
+    tar xf "${PKG_DIR}/${PKG_PREFIX}${PKG}"
+  fi
 done
 
 sed -i "s|E:/mingwbuild/mingw-w64-qt5/pkg/mingw-w64-${CPUARCH}-qt5|${TARGETDIR}/msys2-${CPUARCH}|" ./mingw${ARCH}/lib/pkgconfig/Qt5*.pc
@@ -214,17 +217,20 @@ if [ ! -f pyliblo-${PYLIBLO_VERSION}/build-done ]; then
   fi
   mkdir -p build
   # build
-  ${CC} -pthread -Wall ${CFLAGS} \
+  sed -i 's|#!/bin/sh|#!/usr/bin/env bash|' $(which python3-config)
+  sed -i 's|#include "pyconfig.h"|#include <pyconfig.h>|' src/liblo.c
+  ${CC} -pthread -Wall ${CFLAGS}  \
+    $(python3-config --includes --ldflags) \
     src/liblo.c -c -o build/liblo.o \
     $(python3-config --cflags | awk 'sub("-ne ","")') \
     -D_FORTIFY_SOURCE=2 -fPIC -fno-strict-aliasing \
     -Wdate-time -Werror-implicit-function-declaration -Wfatal-errors
   # link
   ${CC} -pthread -shared ${LDFLAGS} \
-    build/liblo.o -o build/liblo-cpython-37m.dll \
-    -llo $(python3-config --ldflags | awk 'sub("-ne ","")') -lws2_32 -liphlpapi
+    build/liblo.o -o build/liblo-cpython-38m.dll \
+    -llo $(python3-config --ldflags ) -lws2_32 -liphlpapi
   # install
-  install -m 644 build/liblo-cpython-37m.dll ${MSYS2_PREFIX}/lib/python3.7/site-packages/
+  install -m 644 build/liblo-cpython-38m.dll ${MSYS2_PREFIX}/lib/python3.8/site-packages/
   touch build-done
   cd ..
 fi
